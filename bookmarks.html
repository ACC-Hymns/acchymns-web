<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover">
        <link rel="stylesheet" href="./css/bookmarks.css">
        <link rel="stylesheet" href="./css/globals.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    </head>
    <body>
        <div id="songview" class="songpage hidden">
            <div id="menu" class="menu">
                <div class="title">
                    <a id="backButton"><img class="ionicon" src="./assets/chevron-back-outline.svg"/></a>
                    <h1 id="titlenumber"></h1>
                    <a id="bookmarkButton"><img class="ionicon" id="bookmarkIcon" src="./assets/bookmark-outline.svg"/></a>
                </div>
            </div class="menu">
            
            <img class="song_img" id="songimage"></img>
        </div>
        <div id="content" class="content">
            <h1 class="h1">Bookmarks</h1>
            <form role="search" id="form" onkeypress="return event.keyCode != 13">
                <input type="search" id="searchBar" name="searchBar"
                 placeholder="Search for a song title or number..."
                 aria-label="Search through site content">
                <button>
                  <svg viewBox="0 0 1024 1024"><path class="path1" d="M848.471 928l-263.059-263.059c-48.941 36.706-110.118 55.059-177.412 55.059-171.294 0-312-140.706-312-312s140.706-312 312-312c171.294 0 312 140.706 312 312 0 67.294-24.471 128.471-55.059 177.412l263.059 263.059-79.529 79.529zM189.623 408.078c0 121.364 97.091 218.455 218.455 218.455s218.455-97.091 218.455-218.455c0-121.364-103.159-218.455-218.455-218.455-121.364 0-218.455 97.091-218.455 218.455z"></path></svg>
                </button>
            </form>
    
            <div class="title">
                <h2>Bookmarked Songs</h2>
                <a href="#"><img class="ionicon" src="./assets/filter-outline.svg"/></a>
            </div>
            
            <ul id="bookmarksList"></ul>
        </div>
        <nav class="nav">
            <a href="index.html" class="nav__link">
                <img class="ionicon nav__icon" src="./assets/home-outline.svg"/>
                <span class="nav__text">Home</span>
            </a>
            <a href="search.html" class="nav__link">
                <img class="ionicon nav__icon" src="./assets/search-outline.svg"/>
                <span class="nav__text">Search</span>
            </a>
            <a href="#" class="nav__link nav__link--active">
                <img class="ionicon nav__icon--active" src="./assets/bookmark.svg"/>
                <span class="nav__text">Bookmarks</span>
            </a>
            <a href="settings.html" class="nav__link">
                <img class="ionicon nav__icon" src="./assets/settings-outline.svg"/>
                <span class="nav__text">Settings</span>
            </a>
        </nav>
        <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
        <script type="module">
            import { addSongs, getSongFileName } from "/js/song-loader.js";

            const urlParams = new URLSearchParams(window.location.search);
            const bookName = urlParams.get("book");
            const songNum = urlParams.get("song");
            document.getElementById('backButton').href = window.location.pathname;
            if (bookName != null && songNum != null){
                const songView = document.getElementById('songview');
                songView.classList.remove('hidden');
                const searchContent = document.getElementById('content');
                searchContent.classList.add('hidden');

                const songViewTitle = document.getElementById('titlenumber');
                songViewTitle.innerHTML = "";
                const textNode = document.createTextNode(`#${songNum}`);
                songViewTitle.appendChild(textNode);
                
                const songViewImage = document.getElementById('songimage');
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    if(window.localStorage.getItem("songInverted") == "true") {
                        songViewImage.style.filter = "invert(92%)";
                    }
                }
                
                let fileName = getSongFileName(bookName, songNum);
                songViewImage.setAttribute('src', `./books/${bookName}/songs/${fileName}`);
            }
        </script>
        <script type="module" src="./js/bookmarks.js"></script>
        <script type="module" src="./js/bookmark-button.js"></script>
    </body>    
</html>
